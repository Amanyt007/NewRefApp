@model NewRefApp.Data.DTOs.TeamMemberDataDto

@{
    ViewData["Title"] = "Team Members";
    var currentDateTime = DateTime.Now.ToString("hh:mm tt 'IST' on dddd, MMMM dd, yyyy");
    var totalInvite = 0;
    var totalMoney = 0;
}
<div class="container-fluid p-0">
    <div class="card bg-pink-gradient text-center text-white p-3 mb-3">
        <h1>Team</h1>
    </div>
</div>
<div class="container my-4">
    <div class="row text-center bg-white shadow-sm p-4 rounded mb-3">
        <div class="col border-end">
            <div class="text-muted">Referral Earning</div>
            <div class="fw-bold fs-5 text-pink">₹@ViewBag.ReferralData</div>
        </div>
        <div class="col">
            <div class="text-muted">Team Size</div>
            <div class="fw-bold fs-5 text-pink" id="teamSize">@totalInvite</div>
        </div>
    </div>

    <ul class="nav nav-tabs nav-fill rounded bg-pink mb-3 p-2 px-3" id="levelTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="level1-tab" data-bs-toggle="tab" data-bs-target="#level1" type="button" role="tab">Level 1</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="level2-tab" data-bs-toggle="tab" data-bs-target="#level2" type="button" role="tab">Level 2</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="level3-tab" data-bs-toggle="tab" data-bs-target="#level3" type="button" role="tab">Level 3</button>
        </li>
    </ul>

    <div class="tab-content bg-white shadow-sm rounded p-3">
        <!-- LEVEL 1 -->
        <div class="tab-pane fade show active" id="level1" role="tabpanel">
            <p class="text-muted small">Updated as of @currentDateTime</p>
            @if (Model?.Level1 != null && Model.Level1.Any())
            {
                @foreach (var member in Model.Level1)
                {
                    totalInvite++;
                    <div class="d-flex justify-content-between py-2 border-bottom">
                        <span><strong>Mobile:</strong> @member.MobileNumber.Substring(0, 3)***@member.MobileNumber.Substring(member.MobileNumber.Length-3)</span>
                        <span><strong>Purchased:</strong> @(member.IsPurchased ? "Yes" : "No")</span>
                        <span><strong>VIP Level:</strong> @member.VipLevel</span>
                    </div>
                }
            }
            else
            {
                <div class="text-center text-muted py-4">No team members at this level</div>
            }
        </div>

        <!-- LEVEL 2 -->
        <div class="tab-pane fade" id="level2" role="tabpanel">
            <p class="text-muted small">Updated as of @currentDateTime</p>
            @if (Model?.Level2 != null && Model.Level2.Any())
            {
                @foreach (var member in Model.Level2)
                {
                    totalInvite++;
                    <div class="d-flex justify-content-between py-2 border-bottom">
                        <span><strong>Mobile:</strong> @member.MobileNumber.Substring(0, 3)***@member.MobileNumber.Substring(member.MobileNumber.Length - 3)</span>
                        <span><strong>Purchased:</strong> @(member.IsPurchased ? "Yes" : "No")</span>
                        <span><strong>VIP Level:</strong> @member.VipLevel</span>
                    </div>
                }
            }
            else
            {
                <div class="text-center text-muted py-4">No team members at this level</div>
            }
        </div>

        <!-- LEVEL 3 -->
        <div class="tab-pane fade" id="level3" role="tabpanel">
            <p class="text-muted small">Updated as of @currentDateTime</p>
            @if (Model?.Level3 != null && Model.Level3.Any())
            {
                @foreach (var member in Model.Level3)
                {
                    totalInvite++;
                    <div class="d-flex justify-content-between py-2 border-bottom">
                        <span><strong>Mobile:</strong> @member.MobileNumber.Substring(0, 3)***@member.MobileNumber.Substring(member.MobileNumber.Length - 3)</span>
                        <span><strong>Purchased:</strong> @(member.IsPurchased ? "Yes" : "No")</span>
                        <span><strong>VIP Level:</strong> @member.VipLevel</span>
                    </div>
                }
            }
            else
            {
                <div class="text-center text-muted py-4">No team members at this level</div>
            }
        </div>
    </div>
</div>

@* <style>
    .bg-pink {
        background-color: #ea4c89 !important;
    }

    .nav-tabs .nav-link {
        color: #fff;
        border: none;
        margin: 0 5px;
        border-radius: 10px;
        background-color: transparent;
    }

        .nav-tabs .nav-link.active {
            background-color: #fff;
            color: #ea4c89;
            font-weight: 600;
        }

    .text-pink {
        color: #ea4c89 !important;
    }

    .nav-tabs {
        border: none !important;
    }
</style> *@
<script>
    // Set totalInvite value from Razor to JavaScript
    document.getElementById("teamSize").innerText = "@totalInvite";
</script>
